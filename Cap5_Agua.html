
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5. Capítulo 5 · Random Forest para detectar agua &#8212; GeoIA aplicado a Imágenes Satelitales</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Cap5_Agua';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6. Capítulo 6 · Serie Temporales" href="Cap6_ST.html" />
    <link rel="prev" title="4. Capítulo 4 · Máquina de Soporte Vectorial y Árbol de Decisión" href="Cap4_SVM_DT.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logoAgua.png" class="logo__image only-light" alt="GeoIA aplicado a Imágenes Satelitales - Home"/>
    <script>document.write(`<img src="_static/logoAgua.png" class="logo__image only-dark" alt="GeoIA aplicado a Imágenes Satelitales - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Prólogo
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Cap1_Tecnicas.html">1. Capítulo 1 · Teledetección y Aprendizaje Automático</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cap2_RFRosario.html">2. Capítulo 2 · Random Forest en GEE</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cap3_gee_colab.html">3. Capítulo 3 · Random Forest en GEE y Colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cap4_SVM_DT.html">4. Capítulo 4 · Máquina de Soporte Vectorial y árbol de Decisión</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">5. Capítulo 5 · Random Forest para detectar agua</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cap6_ST.html">6. Capítulo 6 · Serie Temporales</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cap7_Datacubes.html">7. Capítulo 7 · Cubos de Imágenes Satelitales</a></li>
<li class="toctree-l1"><a class="reference internal" href="Referencias.html">8. Bibliografía</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/cdg-idera/PAT_INT_GEE" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cdg-idera/PAT_INT_GEE/issues/new?title=Issue%20on%20page%20%2FCap5_Agua.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Cap5_Agua.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Capítulo 5 · Random Forest para detectar agua</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion">5.1. Introducción</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#center-object">5.1.1. Center Object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#buffer">5.1.2. Buffer</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imagenes-sentinel-2">5.1.3. Imágenes Sentinel-2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funcion-para-calcular-ndvi">5.2. Función para calcular NDVI</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#workflow">5.3. Workflow</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#entrenamiento">5.3.1. Entrenamiento</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">5.3.2. Entrenamiento</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificar-la-imagen">5.3.3. Clasificar la imagen</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mascara">5.3.4. MASCARA:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#acurracy-assessment">5.3.5. Acurracy Assessment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exportacion">5.3.6. Exportación</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#video-del-capitulo">5.4. Video del capítulo</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="capitulo-5-random-forest-para-detectar-agua">
<h1><span class="section-number">5. </span>Capítulo 5 · Random Forest para detectar agua<a class="headerlink" href="#capitulo-5-random-forest-para-detectar-agua" title="Link to this heading">#</a></h1>
<section id="introduccion">
<h2><span class="section-number">5.1. </span>Introducción<a class="headerlink" href="#introduccion" title="Link to this heading">#</a></h2>
<p>En este capítulo vamos a aplicar aprendizaje automático a imágenes satelitales para predecir superficies de agua. Utilizaremos datos satelitales de Sentinel-2 para procesar una colección de imágenes correspondientes a una región de estudio y aplicaremos un modelo de Random Forest para clasificar los píxeles en dos categorías: agua y no agua. Es decir, emplearemos una clasificación binaria.</p>
<p>En Google Earth Engine (GEE) podes explorar imagenes Sentinel haciendo click en DATASET para acceder al catálogo de datos y luego hacer en la opción de menú Sentinel y encontrarás todos los productos satelitales Sentinel.</p>
<p>Sentinel-2 es propiedad de la Agencia Espacial Europea <span id="id1">[<a class="reference internal" href="Referencias.html#id8" title="European Space Agency. Sentinel-2: esa's optical high-resolution mission for gmes operational services. European Space Agency, 2015. Consultado el 19 de septiembre de 2025. URL: https://sentinel.esa.int/web/sentinel/missions/sentinel-2.">European Space Agency, 2015</a>]</span>.  En Google Earth Engine tenemos acceso a colecciones de imágenes satelitales Sentinel-1, Sentinel-2, Sentinel-3 y Sentinel-5 <span id="id2">[<a class="reference internal" href="Referencias.html#id7" title="Google Earth Engine. Sentinel satellite imagery collections in google earth engine. Google Earth Engine Data Catalog, 2025. Consultado el 19 de septiembre de 2025. URL: https://developers.google.com/earth-engine/datasets/catalog/sentinel.">Google Earth Engine, 2025</a>]</span>.</p>
<p>Nos vamos a centrar en Sentinel-2, cuyos datos son muy populares.</p>
<p>Se aplican en diversas áreas de monitoreo de la superficie terrestre, incluida la gestión de desastres, la gestión de emergencias, la cuantificación de la tendencia de urbanización y la cobertura del suelo, entre otras.</p>
<figure class="align-default" id="fig-posit-1">
<a class="reference internal image-reference" href="_images/PosIT-1.png"><img alt="_images/PosIT-1.png" src="_images/PosIT-1.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.1 </span><span class="caption-text">Algunas aplicaciones de Sentinel-2</span><a class="headerlink" href="#fig-posit-1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Bien creamos un nuevo script denominado A001_RandomForest_CuerposDeAguaComahue</p>
<p>Nuestra área de estudio será la región del Comahue principalmente la provincia del Neuquén y la de Rio negro. Vamos a crear nuestra región de estudio, nuestraregión de interés o ROI.</p>
<figure class="align-default" id="fig-km">
<a class="reference internal image-reference" href="_images/km.png"><img alt="_images/km.png" src="_images/km.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.2 </span><span class="caption-text">Sobre el area de estudio</span><a class="headerlink" href="#fig-km" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="fig-p-3">
<a class="reference internal image-reference" href="_images/p_3.png"><img alt="_images/p_3.png" src="_images/p_3.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.3 </span><span class="caption-text">Etapa: Clasificar la imagen</span><a class="headerlink" href="#fig-p-3" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Como no estamos interesados en los límites provinciales precisos de la provincia, debido a que queremos abarcar los rios que componen los limites naturales provinciales,
no utilizaremos los límites administrativos exactos disponibles en la IDE de la provincia de RN y Nqn, o en el Instituto Geográfico Nacional
sino que utilizaremos el conjunto de datos de Capas de Unidades Administrativas Globales de Google Earth Engine.</p>
<p>Esto nos permitirá aprender un poco más sobre este conjunto de datos de Unidades Administrativas Globales:</p>
<p>FAO GAUL: Global Administrative Unit Layers 2015, First-Level Administrative Units</p>
<figure class="align-default" id="fig-posit-2">
<a class="reference internal image-reference" href="_images/PosIT-2.png"><img alt="_images/PosIT-2.png" src="_images/PosIT-2.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.4 </span><span class="caption-text">Sobre Global Administrative Unit Layers</span><a class="headerlink" href="#fig-posit-2" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="fig-tabla-1">
<a class="reference internal image-reference" href="_images/Tabla_1.png"><img alt="_images/Tabla_1.png" src="_images/Tabla_1.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.5 </span><span class="caption-text">Tabla de variables independientes y dependientes</span><a class="headerlink" href="#fig-tabla-1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Las Capas de Unidades Administrativas Globales (GAUL) recopilan y difunden la mejor información disponible sobre unidades administrativas para todos los países del mundo, contribuyendo a la estandarización del conjunto de datos espaciales que representan las unidades administrativas.</p>
<p>Llamando a esta colección de imágenes, tendremos los límites de administración para todos los países.</p>
<p>&lt;&lt;ee.FeatureCollection(“FAO/GAUL/2015/level1”)&gt;&gt;</p>
<p>Si visualizamos el esquema de tabla de este conjunto de datos, existen algunos atributos que utilizaremos para filtrar:
ADM0_CODE tiene el codigo de pais, y ADM0_NAME tiene el nombre de pais,
ADM1_CODE tiene el code of unidades administrativas de primer nivel y ADM1_NAME tiene Name of unidades administrative de primer nivel</p>
<p>Utilizando ADM0_NAME  filtraremos Argentina y utilizando y ADM1_NAME filtraremos la unidad administrativa de la provincia del neuquen:</p>
<p>Primero mostramos como ADM0_NAME nos permite filtrar por nombre de país en este caso, Argentina</p>
<p>Luego mostramos como utilizando ADM1_NAME podemos filtrar las provincia de Rio Negro y Neuquen.
Cuando agregamos esta capa al mapa la llamamos Comahue</p>
<p>En ambos casos se inspeccionan datos utilizando el inspector de Google Earth Engine para ver
como están escritos los nombres de provincias, por ejemplo Neuquén no esta con acento.</p>
<section id="center-object">
<h3><span class="section-number">5.1.1. </span>Center Object<a class="headerlink" href="#center-object" title="Link to this heading">#</a></h3>
<p>Centramos nuestra zona de estudio utilizando la función centerObject, haciendo variar el nivel de zoom.</p>
<p>La funcion centerObjet  es una función que te ayuda a cambiar la etiqueta de zoom.
Segun la documentacion el nivel de zoom es un valro entre 0 y 24,
Podes ajustar el nivel de zoom.
Si no ajustás el parametro de zoom, no se ampliará el área que te interesa.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="nx">roi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ee</span><span class="p">.</span><span class="nx">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;FAO/GAUL/2015/level1&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;ADM0_NAME&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Argentina&#39;</span><span class="p">))</span><span class="w">  </span><span class="c1">// Filtrar por país</span>
<span class="w">  </span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">ee</span><span class="p">.</span><span class="nx">Filter</span><span class="p">.</span><span class="nx">inList</span><span class="p">(</span><span class="s1">&#39;ADM1_NAME&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s1">&#39;Neuquen&#39;</span><span class="p">]));</span>
</pre></div>
</div>
</section>
<section id="buffer">
<h3><span class="section-number">5.1.2. </span>Buffer<a class="headerlink" href="#buffer" title="Link to this heading">#</a></h3>
<p>Aplicaremos un buffer de 5 km para incluir los límites naturales completos que comprenden rios que separan provincias.</p>
<p>Se puede crear un buffer para un FeatureCollection usando el método .map() para aplicar una operación a cada Feature en el FeatureCollection de unidades administrativas.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Crear un buffer de 10 km (10,000 metros)</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">bufferedRoi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">roi</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">feature</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">feature</span><span class="p">.</span><span class="nx">buffer</span><span class="p">(</span><span class="mf">10000</span><span class="p">);</span><span class="w"> </span><span class="c1">// Agregar buffer de 10 km</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Esta es nuestra área de estudio.</p>
</section>
<section id="imagenes-sentinel-2">
<h3><span class="section-number">5.1.3. </span>Imágenes Sentinel-2<a class="headerlink" href="#imagenes-sentinel-2" title="Link to this heading">#</a></h3>
<p>A continuación buscamos Sentinel-2 y seleccionamos las colecciones de imágenes
Harmonized sentinel-2 MSI (MultiSpectralInstrument) level 1-c</p>
<p>Copiamos su identificación que utilizarmeos en la deficion de una colección de imágenes sentinel denominada IMAGE</p>
<hr class="docutils" />
<p>Filtraremos imágenes sentinel del año 2024, utilizaré datos de todo el año 2024, es decir, fecha de comienzo: 1 de enero de 2024 y fecha de finalización el 1 de enero de 2025
(esta ultima fecha se excluye) como podemos comprobar en la documentación de FilterData
un método que se aplica a un FeatureColection (start date es inclusive pero end date es exclusive).</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<hr class="docutils" />
<p>Vamos a usar un filtro de nubes aquí. Cuando se utilizan datos satelitales, generalmente hay contaminación por nubes.
Deseamos utilizar la mayor cantidad posible de imágenes libres de nubes. Entonces, aquí vamos a aplicar un filtro para seleccionar imagens con menos de un 10% de nubes.</p>
<p>Esto se logra utilizando metadatos de la imagen satelital , si consultmaos las propiedadesde la imagen, existe un atributo: CLOUDY_PIXEL_PERCENTAGE
que representa el Porcentaje de píxeles nublados específicos</p>
<p>esto  nos permite utilizar una imagen de nubes en la que la contaminación de las nubes es menor al 10 %. Podes ajustar este parámetro en función del área de estudio según tu criterio de análisis.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<hr class="docutils" />
<p>filterBounds(roi) tiene un propósito: Filtrar las imágenes en la colección para incluir solo aquellas que intersectan con la región de interés (roi).
Limita la cantidad de imágenes en la colección para que solo contenga aquellas que cubren total o parcialmente la región definida por roi. Esto reduce el número de imágenes procesadas y mejora la eficiencia.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<hr class="docutils" />
<p>Lo que necesitamos es una sola imagen. Por lo tanto, necesitamos agregar todas las imágenes mediante un reductor o una agregación estadística. En este caso, vamos a utilizar la mediana.
Se suele recomendar la mediana como mínimo mejor que la media. Se evitará incluir algunos valores atípicos, por lo que se utilizará el valor de la mediana.
De esta manera, se evita incluir valores atípicos en el proceso de agregación estadística. En este caso, utilizamos la mediana.</p>
<p>Luego recortamos la imagen en función la región de estudio CON clipToCollection(roi)
eL Propósito ES RecortaR la imagen resultante al contorno exacto de la colección o región (roi).
Tras combinar las imágenes (en este caso, usando .median()), recorta la salida final para que coincida exactamente con el contorno de roi.</p>
<p>Ahora tenemos una imagen Sentinel más limpia, que está lista para nuestra clasificación de aprendizaje automático.
aHORA VAMOS A UTILIZAR ESTA FUNCIÓN EN LA COLECCION DE IMAGENES sENTINEL</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>Vamos a aplicar algunos parámetros de filtrado a la colección de imágenes Sentinel.</p>
<p>Para ello utilizaremos la funcion Map que ejecuta la función que definimos anteriormente agregarNDVI a todo feature  del featureColetcion en otras palabaras a toda imagen de la colección de imágenes.
En otras palabras MAP permite aplicar la función agregarNDVI a cada imagen de la colección de imágenes.</p>
<p>Cargamos nuestra imagen, a nuestro mapa con addLayer, si la imagen sentinel no cuenta con parámetros de visualización se verá negra,
podemos importar los parámetros de visualización , utilizando la configuración de la capa, seleccionando las 3 bandas RGB, bandas 4,3 y2 y un stretch de 98%
que permite visualizar los valores de estas tres bandas,</p>
<p>Aplicamos e importamos esta configuración.
hacemos una prueba con estos parámetros y ya visualizamos la colección de imágenes.</p>
<p>En su defecto definir nuestros propiso parámetros con una variable visParams
para ello, creamos un parámetro de visualización,</p>
<p>vamos a utilizar una composición de colores rojo, verde, azul (RGB).
En este caso, vamos a proporcionar las bandas que vamos a utilizar aquí, banda 4, banda 3, banda 2.
No las estamos utilizando para nuestro modelo, sino solo para visualizar la imagen en el mapa.
Y luego un valor mínimo y máximo en función de los datos de reflectancia de la superficie PARA ESTAS BANDAS</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="nx">visParams</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">bands</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span><span class="s1">&#39;B2&#39;</span><span class="p">],</span><span class="w"> </span><span class="nx">min</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nx">max</span><span class="o">:</span><span class="w"> </span><span class="mf">3000</span><span class="p">};</span>
<span class="nb">Map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span><span class="w"> </span><span class="nx">visParams</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Sentinel 2024&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="funcion-para-calcular-ndvi">
<h2><span class="section-number">5.2. </span>Función para calcular NDVI<a class="headerlink" href="#funcion-para-calcular-ndvi" title="Link to this heading">#</a></h2>
<p>En nuestra clasificación aplicando aprendizaje automático utilizaremos valores de reflectancia de ciertas bandas de la imagen Sentinel en conjunto con el índice NDVI.
Utilizaremos filtros de nubes, y filtros temporales</p>
<p>El NDVI es el índice de vegetación diferencial normalizado que ayuda a monitorear la salud de la vegetación.
Por lo tanto, un NDVI más alto generalmente indica una cobertura vegetal densa o una vegetación más verde.
Valores negativos son comunes en cuerpos de agua abiertos.
mientras que Valores cercanos a 0 pueden observarse en agua con sedimentos o cubierta parcial por vegetación flotante.</p>
<figure class="align-default" id="fig-posit-ndvibis">
<a class="reference internal image-reference" href="_images/PosIT-NDVIbis.png"><img alt="_images/PosIT-NDVIbis.png" src="_images/PosIT-NDVIbis.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.6 </span><span class="caption-text">Indice Espectral NDVI</span><a class="headerlink" href="#fig-posit-ndvibis" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Rangos típicos del NDVI:</p>
<p>Agua: -1 a ~0
- Valores negativos son comunes en cuerpos de agua abiertos.
- Valores cercanos a 0 pueden observarse en agua con sedimentos o cubierta parcial por vegetación flotante.
Suelo desnudo: 0 a 0.2
Vegetación escasa: 0.2 a 0.5
Vegetación densa: 0.5 a 1</p>
<figure class="align-default" id="fig-valoresndvi">
<a class="reference internal image-reference" href="_images/valoresNDVI.png"><img alt="_images/valoresNDVI.png" src="_images/valoresNDVI.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.7 </span><span class="caption-text">Valores típicos del NDVI</span><a class="headerlink" href="#fig-valoresndvi" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Lo primero que debemos hacer es escribir una función que calcule el NDVI.
Vamos a crear una función denominada agregarNDVI para calcular el NDVI, que vamos a utilizar en nuestra clasificación de aprendizaje automático.</p>
<p>También podríamos utilizar otros índices como:</p>
<ul class="simple">
<li><p>NDWI (Índice de Diferencia Normalizada del Agua)</p></li>
<li><p>MNDWI (Índice de Diferencia Normalizada del Agua Modificado)</p></li>
<li><p>AWEI (Índice de Extracción Automática del Agua)</p></li>
<li><p>LSWI (Índice del Agua Basado en Tierra)</p></li>
<li><p>WI (Índice del Agua)</p></li>
</ul>
<figure class="align-default" id="fig-indicesaguabis">
<a class="reference internal image-reference" href="_images/IndicesAguaBis.png"><img alt="_images/IndicesAguaBis.png" src="_images/IndicesAguaBis.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.8 </span><span class="caption-text">Algunos Indices espectrales en el dominio de aplicación Agua</span><a class="headerlink" href="#fig-indicesaguabis" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Nuestra función agregarNDVI, tiene un parámetro de entrada imagen. Podemos llamarlo imagen o algún otro nombre significativo.</p>
<p>La primera instrucción es definir la variable NDVI. que es igual a la diferencia normalizada de la banda ocho, la banda infrarroja cercana, y la banda cuatro, la banda roja de la imagen Sentinel.
Si consultamos la documentación del método normalizedDifference, este metodo se aplica a una imagen. Aca se utiliza la notación orientada a objetos objeto.metodo() el objeto es 1 imagen y el método es normalizedDifference.</p>
<p>consultando la documentaicon de los métodos que se aplican a un objeto, la función normalizedDifference, una función incorporada a Google Earth Engine, calcula la diferencia normalizada entre dos bandas.</p>
<p>Es necesario proporcionar las dos bandas a este método para obtener el índice ndvi calculado.</p>
<p>El método no tiene parámetros obligatorios, cuando los parámetros en la documentación están en letra itálica esto signfiica que los parámetros son opcionales.
Si no se especifican las bandas a utilizar, es decir no se proporcionan parámetros, el método utiliza las dos primeras bandas.
La diferencia normalizada se calcula como (primero − segundo) / (primero + segundo)</p>
<p>para nuestro ejemplo:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nx">first</span><span class="w"> </span><span class="err">−</span><span class="w"> </span><span class="nx">second</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="nx">first</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">second</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">B8</span><span class="w"> </span><span class="err">−</span><span class="w"> </span><span class="nx">B4</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="nx">B8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">B4</span><span class="p">)</span>
</pre></div>
</div>
<p>es decir</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">NDVI</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">NIR</span><span class="err">−</span><span class="nx">RED</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="nx">NIR</span><span class="o">+</span><span class="nx">RED</span><span class="p">)</span>
</pre></div>
</div>
<p>Asi de simple, es calcular un índice para una imagen satelital. Este acercamiento nos permite definir otros índices como: NDWI, MNDWI, y otros mostrados en la Figura a continuación:</p>
<figure class="align-default" id="fig-indicesagua">
<a class="reference internal image-reference" href="_images/IndicesAgua.png"><img alt="_images/IndicesAgua.png" src="_images/IndicesAgua.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.9 </span><span class="caption-text">Indices Espectrales con el mismo patron de fórmula matemática</span><a class="headerlink" href="#fig-indicesagua" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Luego, finalmente, la funcion devuelve nuestra imagen, a la cual le agregaremos estas banda calculada con el NDVI.</p>
<hr class="docutils" />
<p>Esta función se define para una imagen, luego calculará técnicamente el NDVI para todas las imágenes dentro de la colección de imágenes con la operación MAP.</p>
<p>Antes de ejecutar este código comprobamos que la colección de imágenes no cuenta inicialmente con este índice NDVI, y que solo luego de ejecutar el código es posible ver esta nuevo dato en cada imagen</p>
<figure class="align-default" id="fig-falsocolor">
<a class="reference internal image-reference" href="_images/FalsoColor.png"><img alt="_images/FalsoColor.png" src="_images/FalsoColor.png" style="width: 70%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.10 </span><span class="caption-text">Falso Color: Descripción</span><a class="headerlink" href="#fig-falsocolor" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Generaremos una imagen de FALSO COLOR ,  utilizando las bandas B5 (NIR), B4 (Red), y B3 (Green) del Sentinel-2 ,  que nos permitirá detectar agua y generar mas facilmente los puntos de entrenamiento</p>
<p>Esto permite detectar cuerpos de agua de manera efectiva debido a cómo el agua interactúa con la luz en estas longitudes de onda
En un mapa con este esquema de falso color:</p>
<ul class="simple">
<li><p>Ríos, lagos y océanos: Oscuros o negros.</p></li>
<li><p>Vegetación: Rojo brillante.</p></li>
<li><p>Suelo desnudo o urbano: Varía entre tonos de gris y verde tenue.</p></li>
</ul>
<p>Estos son los datos de Sentinel que vamos a utilizar para nuestro aprendizaje automático, es decir, la clasificación supervisada Random forest.</p>
</section>
<hr class="docutils" />
<section id="workflow">
<h2><span class="section-number">5.3. </span>Workflow<a class="headerlink" href="#workflow" title="Link to this heading">#</a></h2>
<p>Para aplicar la tecnica supervisada de random forest tendremos en cuenta el flujo de trabajo</p>
<figure class="align-default" id="fig-workflow">
<a class="reference internal image-reference" href="_images/Workflow.png"><img alt="_images/Workflow.png" src="_images/Workflow.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.11 </span><span class="caption-text">Workflow para aplicar ML a imágenes satelitales</span><a class="headerlink" href="#fig-workflow" title="Link to this image">#</a></p>
</figcaption>
</figure>
<section id="entrenamiento">
<h3><span class="section-number">5.3.1. </span>Entrenamiento<a class="headerlink" href="#entrenamiento" title="Link to this heading">#</a></h3>
<p>Ahora crearemos datos de entrenamiento y luego ejecutaremos nuestro aprendizaje automático.</p>
<figure class="align-default" id="fig-p-1">
<a class="reference internal image-reference" href="_images/p_1.png"><img alt="_images/p_1.png" src="_images/p_1.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.12 </span><span class="caption-text">Etapa: Seleccionar las muestras de entrenamiento</span><a class="headerlink" href="#fig-p-1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Vamos a crear los datos de entrenamiento:</p>
<p>Para crear los datos de entrenamiento, utilizando la herramienta de dibujo del panel de Earth Engine.</p>
<p>Crearemos una nueva capa, denominada agua, de tipo featureColeccion, y defiNImos una propiedad denomninada categoriaAgua, con valor 1.</p>
<p>También crearé otro feature collection denominado NO-AGUA, con una propiedad denominada categoriaAgua, con valor 0.</p>
<p>De esta forma tenemos dos feature collection Agua y NoAgua, con cero features.</p>
<p>vamos a comenzar a recopilar los datos, primero para el featureCollection agua, vamos a resaltar aquella capa para la cual deseamos capturar datos de entrenamiento.</p>
<p>En este caso, se resaltamos la capa agua. Lo que haremos será recopilar la mayor cantidad posible de pixeles que representen agua y asegurarnos de que estén en nuestro region de estudio.</p>
<p>Vamos a capturar tantos puntos como sea posible aquí y luego lo vamos a cambiar un poco de zonas para obtener muestras espacialmente dispersas y representativas.</p>
<p>Continuamos capturando más puntos:</p>
<hr class="docutils" />
<p>Esto debería ser suficiente para nuestro feature collection de agua.</p>
<hr class="docutils" />
<p>Continuamos con nuestro featureCollectoin de no-agua.</p>
<p>podemos caputrar puntos que no sean agua, esto puede ser pixeles de una zona urbana, un cultivo o un bosque.</p>
<p>Esta es un área agrícola de cultivo marcaeremos algunos putnos.</p>
<p>Podemos ir a alguna ciudad importante solo para capturar pixels de la zona urbana.</p>
<p>Podemos capturar puntos de cobertura vegetal tambien.</p>
<p>Capturar puntos de una zona industrial. . Y estamos a punto de terminar nuestra captura de muestras de no agua.</p>
<p>Estos puntos de control en el terreno, deberían ser suficientes para nuestro análisis.</p>
<p>Si realmente estás haciendo un análisis científico real o tu proyecto, necesitamos capturar varios puntos de datos representativos y asegurarnos de que la calidad de los puntos de datos sea buena.</p>
<p>Nuestro próximo paso es combinar ambos featureCollection en un solo featureCollection, esto  lo hace la función MERGE.
fusiona AMBAS CAPAS: AGUA Y NO AGUA EN UNA SOLA COLECCION denominada training</p>
<p>La fusión o merge, combinó estos dos colecciones en una, la cual contiene tiene aproximadamente xxxx puntos de datos de entrenamiento, PUNTOS DE clase agua y DE clase no agua.</p>
<hr class="docutils" />
<p>Muy bien. Ahora  estamos listos para nuestra clasificación de aprendizaje automático</p>
<p>La etiqueta es CategoriaAgua y representa nuestra etiqueta para la clasificación de aprendizaje automático o la clasificación supervisada.
Recorda que la definimos cuando creamos los dos featureCollection de datos de entrenamiento agua y no-agua.
Esa será la etiqueta para nuestra clasificación.</p>
<p>Vamos a utilizar para el entrenamiento las bandas dos, tres, cuatro, ocho y NDVI de la imagen del satélite Sentinel.
Extraemos las bandas Sentinel para estos datos de entrenamiento que hemos capturado.</p>
<figure class="align-default" id="fig-tabla-comahue">
<a class="reference internal image-reference" href="_images/Tabla_Comahue.png"><img alt="_images/Tabla_Comahue.png" src="_images/Tabla_Comahue.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.13 </span><span class="caption-text">Variables Independientes y Dependientes</span><a class="headerlink" href="#fig-tabla-comahue" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Para obtener estos datos de la imagen utilizamos la función sampleRegions
vamos a utilizar la resolución de 10 metros, la resolución más alta posible de los datos de Sentinel-2.</p>
<p>SampleRegions permite definir la tabla que entrena el modelo de clasificación supervisada.
los parámetro de esta función son un diccionario de JavaScript que incluye:</p>
<p>En collection especificamos la coleccion de imagenes Sentinel con las bandas seleccionadas
En properties indicamos la etiqeuta que deseamos predecir, en este caso categoriaAgua, que representa la propiedad o etiqueta para nuestro entrenamiento.
En scale indicamos la escala es la resolución espacial, que es de 10 metros, porque estamos usando las bandas Sentinel con una resolución de 10 metros.</p>
<p>Podemos imprimir la tabla de entrenamiento que vamos a utilizar para la clasificación de aprendizaje automático.
Contamos con el valor de las bandas Sentinel seleccionadas, la banda NDVI y la etiqueta CategoriaAgua.</p>
<p>necesitamos separar algunos de los datos para entrenar el modelo y también algunos de los datos para evaluarlo.</p>
<p>Por lo tanto, dividiremos esos datos: crearemos una columna aleatoria y luego solo el 70 % de los datos se utilizarán para entrenar nuestro modelo.
Y luego, el conjunto de prueba aquí será la evaluación, que es el 30 % de datos restantes.</p>
</section>
<section id="id3">
<h3><span class="section-number">5.3.2. </span>Entrenamiento<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<figure class="align-default" id="fig-p-2">
<a class="reference internal image-reference" href="_images/p_2.png"><img alt="_images/p_2.png" src="_images/p_2.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.14 </span><span class="caption-text">Etapa Entrenamiento del Clasificador</span><a class="headerlink" href="#fig-p-2" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>En este paso entrenemos el modelo para luego aplicarlo a la imagen con el fin de generar un mapa de masa de agua.</p>
<p>El paso de entrenar el modelo consiste en aplicar la clasificación supervisada de random forest con los datos de entremiento</p>
<p>Tendrás features, que son datos de entrenamiento, que es el conjunto de entrenamiento,
luego una etiqueta, necesita una etiqueta para la clasificación.
y luego, finalmente, las bandas, que usamos para hacer la predicción, que son las bandas Sentinel.</p>
<p>Entonces, cuando ejecutes esto, entrenarás el modelo de aprendizaje automático.
Cuando lo haga, el modelo de aprendizaje automático se entrenará en función de nuestros datos de entrenamiento en las bandas Sentinel.</p>
</section>
<section id="clasificar-la-imagen">
<h3><span class="section-number">5.3.3. </span>Clasificar la imagen<a class="headerlink" href="#clasificar-la-imagen" title="Link to this heading">#</a></h3>
<figure class="align-default" id="id4">
<a class="reference internal image-reference" href="_images/p_3.png"><img alt="_images/p_3.png" src="_images/p_3.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.15 </span><span class="caption-text">Etapa Clasificar la imagen</span><a class="headerlink" href="#id4" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>El siguiente paso es aplicar este modelo, que es el clasificador, a la imagen, la imagen Sentinel.
Simplemente se va a aplicar el modelo para generar una clasificación.</p>
<p>Ahora, podemos ver la imagen, que es una clasificación.
El siguiente paso es ver nuestra imagen clasificada en una pantalla aquí.</p>
</section>
<section id="mascara">
<h3><span class="section-number">5.3.4. </span>MASCARA:<a class="headerlink" href="#mascara" title="Link to this heading">#</a></h3>
<p>en el comando: var water = classifiedImage.updateMask(classifiedImage);</p>
<p>La función updateMask utiliza los valores de classified como una máscara. Los píxeles con valor 1 (agua) permanecen visibles, mientras que los píxeles con valor 0 (no agua) se enmascaran (ocultan).</p>
<p>Esto se traduce en:</p>
<p>Si un píxel tiene valor 1 → Se mantiene visible en la nueva variable water.
Si un píxel tiene valor 0 → Se vuelve invisible en water.</p>
<p>crear un parámetro de visualización: cuyo parámetros son el mínimo y el máximo. Por lo tanto, se trata simplemente de un binario de cero y uno.
El azul es para la clase de agua y el blanco para la clase de no agua y luego agregaremos la capa al mapa.</p>
<p>Agregaremos la capa al mapa, pasaremos la imagen clasificada aquí, los parámetros de visualización y la llamaremos agua.
Entonces, simplemente ejecutemos eso. Y cuando lo ejecutemos, veremos nuestra clase de agua.</p>
<p>Esta es nuestra clase de agua, que se superpone a la imagen de Sentinel. Y esa es nuestra clase de agua basada en el aprendizaje automático en la imagen de Sentinel.
Esta es nuestra clasificación. Se trata de una clasificación predicha por un modelo basado en el aprendizaje automático,
específicamente en un algoritmo de random forest o bosque aleatorio en la plataforma Earth Engine que utiliza datos satelitales Sentinel2 de 10 metros.</p>
</section>
<section id="acurracy-assessment">
<h3><span class="section-number">5.3.5. </span>Acurracy Assessment<a class="headerlink" href="#acurracy-assessment" title="Link to this heading">#</a></h3>
<figure class="align-default" id="fig-p-4">
<a class="reference internal image-reference" href="_images/p_4.png"><img alt="_images/p_4.png" src="_images/p_4.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5.16 </span><span class="caption-text">Etapa Evaluación de Precisión</span><a class="headerlink" href="#fig-p-4" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Como hemos mencionado en anteriores videos, hay algunos pasos después de este posprocesamiento y tenemos que calcular evaluaciones de precisión de estos datos,</p>
<p>Utilizaremos la función de matriz de confusión.
Entonces, vamos a utilizar el conjunto de prueba y luego el clasificador. Este es nuestro modelo, el modelo de entrenamiento.
Utilizamos los datos del conjunto de prueba, que están configurados para la evaluación.</p>
<p>El primero es el valor real, que es el valor observado en función de este conjunto de pruebas, Y el siguiente es el valor previsto, que es la clasificación.
Una vez que se proporcionan estos parámetros, se va a crear una evaluación de precisión, es decir, valores.</p>
<p>Algunos de estos valores incluyen una matriz de confusión, una tabla y también la precisión general, es decir, la precisión del productor y la precisión del consumidor.</p>
<p>Básicamente, nos limitaremos a observar la precisión general y ejecutaremos la prueba basándonos en estos XXX puntos de datos aproximadamente.
Veamos cuál es nuestra precisión.
Parece que es 100 %, bastante buena, pero creo que si capturamos más puntos de datos, la razón por la que esto es 100 % cierto es que:</p>
<ul class="simple">
<li><p>A, el agua es bastante fácil de predecir,</p></li>
<li><p>B, hemos utilizado la resolución de 10 metros, que también es otro factor.</p></li>
</ul>
</section>
<section id="exportacion">
<h3><span class="section-number">5.3.6. </span>Exportación<a class="headerlink" href="#exportacion" title="Link to this heading">#</a></h3>
<p>La última parte a considerar, es que si deseas usar esta clasificación fuera de Google Earth Engine, digamos un software GIS estándar, como QGIS o ArcGIS
vas a usar la función Export.image.toDrive para exportar, ya sabes, tu mapa de agua.</p>
<p>Cuando lo ejecutes, lo verás en tu Google Drive. Una vez que hayas completado esto, verás los datos o la imagen en tu Google Drive.
Luego, lo descargarás desde Google Drive a tu equipo local y lo abrirás en un software de GIS estándar.</p>
<p>Así es como se aplica la clasificación de aprendizaje automático, los datos satelitales en este caso Sentinel en la API de Google Earth Engine Cloud y se realiza, ya sabes,
captura tus propios datos de entrenamiento,
desarrolla un modelo de aprendizaje automático,
aplicas el modelo para clasificar la imagen de la region de estudio
estudias el rendimiento de tu modelo y
también exporta tu clasificación final a tu Google Drive.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">graphviz</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">graphviz</span>

<span class="c1"># Instalar dependencias adicionales para la conversión de PDF a imagen</span>
<span class="err">!</span><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="o">-</span><span class="n">qq</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">poppler</span><span class="o">-</span><span class="n">utils</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">pdf2image</span>


<span class="c1"># Importar las librerías necesarias</span>
<span class="kn">import</span> <span class="nn">graphviz</span>
<span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">files</span>
<span class="kn">from</span> <span class="nn">pdf2image</span> <span class="kn">import</span> <span class="n">convert_from_path</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Definir las reglas del árbol de decisión en formato DOT</span>
<span class="n">dot_data</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">digraph DecisionTree {</span>
<span class="s2"> node [shape=box, style=&quot;filled, rounded&quot;, color=&quot;black&quot;, fontname=helvetica];</span>
<span class="s2"> edge [fontname=helvetica];</span>
<span class="s2"> 0 [label=&lt;B8 &amp;le; 969.0000&lt;br/&gt;score = 0.4649&gt;, fillcolor=&quot;#00000000&quot;];</span>
<span class="s2"> 1 [label=&lt;class = 1&gt;, fillcolor=&quot;#00000000&quot;, shape=ellipse];</span>
<span class="s2"> 0 -&gt; 1 [labeldistance=2.5, labelangle=45, headlabel=&quot;True&quot;];</span>
<span class="s2"> 2 [label=&lt;class = 0&gt;, fillcolor=&quot;#00000000&quot;, shape=ellipse];</span>
<span class="s2"> 0 -&gt; 2 [labeldistance=2.5, labelangle=-45, headlabel=&quot;False&quot;];</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Crear el gráfico a partir del DOT</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">dot_data</span><span class="p">)</span>

<span class="c1"># Renderizar el árbol de decisión en formato PDF</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;decision_tree&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">cleanup</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Convertir el PDF a imagen</span>
<span class="n">images</span> <span class="o">=</span> <span class="n">convert_from_path</span><span class="p">(</span><span class="s1">&#39;decision_tree.pdf&#39;</span><span class="p">)</span>

<span class="c1"># Mostrar la imagen del árbol de decisión</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  <span class="c1"># Desactivar los ejes para que solo se vea la imagen</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="video-del-capitulo">
<h2><span class="section-number">5.4. </span>Video del capítulo<a class="headerlink" href="#video-del-capitulo" title="Link to this heading">#</a></h2>
<p>Podes mirar el video asociado a este capítulo en el canal de youtube de IDERA: <a class="reference external" href="https://www.youtube.com/watch?v=-DMd6LXIEkE&amp;amp;t=610s">https://www.youtube.com/watch?v=-DMd6LXIEkE&amp;t=610s</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "cdg-idera/PAT_INT_GEE",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Cap4_SVM_DT.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Capítulo 4 · Máquina de Soporte Vectorial y Árbol de Decisión</p>
      </div>
    </a>
    <a class="right-next"
       href="Cap6_ST.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Capítulo 6 · Serie Temporales</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion">5.1. Introducción</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#center-object">5.1.1. Center Object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#buffer">5.1.2. Buffer</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imagenes-sentinel-2">5.1.3. Imágenes Sentinel-2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funcion-para-calcular-ndvi">5.2. Función para calcular NDVI</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#workflow">5.3. Workflow</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#entrenamiento">5.3.1. Entrenamiento</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">5.3.2. Entrenamiento</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificar-la-imagen">5.3.3. Clasificar la imagen</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mascara">5.3.4. MASCARA:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#acurracy-assessment">5.3.5. Acurracy Assessment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exportacion">5.3.6. Exportación</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#video-del-capitulo">5.4. Video del capítulo</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Luis Reynoso (IDERA-GTT CDG)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>